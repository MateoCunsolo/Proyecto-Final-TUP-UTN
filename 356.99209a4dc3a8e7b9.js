"use strict";(self.webpackChunkProyecto=self.webpackChunkProyecto||[]).push([[356],{8356:(X,d,o)=>{o.r(d),o.d(d,{UserModule:()=>S});var c=o(177),u=o(4937),F=o(467),a=o(9417),e=o(4438),p=o(9885),h=o(1765);function P(s,l){1&s&&(e.j41(0,"span",7)(1,"span",8),e.EFF(2,"X"),e.k0s(),e.EFF(3,"The field is required"),e.k0s())}function C(s,l){1&s&&(e.j41(0,"span",7)(1,"span",8),e.EFF(2,"X"),e.k0s(),e.EFF(3,"Minimum 4 characters"),e.k0s())}let E=(()=>{class s{constructor(n,r,t){this.fb=n,this.router=r,this.userService=t,this.userName="",this.userId=0,this.changeUsernameForm=this.fb.group({newUserName:new a.MJ("",[a.k0.required,a.k0.minLength(4)])})}ngOnInit(){let n=sessionStorage.getItem("user")||null;null!==n&&(n=n.replace(/[^0-9]/g,""),this.userId=parseInt(n))}ChangeUsername(){var n=this;return(0,F.A)(function*(){if(n.changeUsernameForm.invalid)return;const r=n.changeUsernameForm.controls.newUserName.value;n.userService.checkIfUsernameExists(r).subscribe(t=>{t?alert("Username already taken. Please try another one!"):n.userService.getUserName(n.userId).then(i=>{n.userName=i[0].username,""!==n.userName&&(n.userService.changeUsername(n.userId,r),alert("Username changed successfully"),n.router.navigate(["home"]))})})})()}validate(n,r){return this.changeUsernameForm.controls[n].getError(r)&&this.changeUsernameForm.controls[n].touched}static#e=this.\u0275fac=function(r){return new(r||s)(e.rXU(a.ok),e.rXU(u.Ix),e.rXU(p.D))};static#n=this.\u0275cmp=e.VBU({type:s,selectors:[["app-change-name"]],decls:12,vars:4,consts:[[1,"contenedor-forms","flex-center-100vh"],[1,"flex-center-local","forms",3,"ngSubmit","formGroup"],[1,"title"],["src","assets/logo-user-large.png"],["type","text","name","","id","username","placeholder","New Username","formControlName","newUserName","pattern","^(?!\\s*$).+","title","It cannot be blank",1,"inputs-values","inputs-all"],["class","error-message",4,"ngIf"],["type","submit","name","","id","in-change","value","Change Username",1,"inputs-sumbit","inputs-all",3,"disabled"],[1,"error-message"],[1,"cross-error"]],template:function(r,t){1&r&&(e.j41(0,"div",0)(1,"form",1),e.bIt("ngSubmit",function(){return t.ChangeUsername()}),e.j41(2,"h3",2),e.nrm(3,"img",3),e.EFF(4,"Change Username"),e.k0s(),e.j41(5,"p"),e.EFF(6,"Write your new Username"),e.k0s(),e.nrm(7,"input",4),e.DNE(8,P,4,0,"span",5)(9,C,4,0,"span",5),e.nrm(10,"input",6),e.k0s()(),e.nrm(11,"app-footer")),2&r&&(e.R7$(),e.Y8G("formGroup",t.changeUsernameForm),e.R7$(7),e.Y8G("ngIf",t.validate("newUserName","required")),e.R7$(),e.Y8G("ngIf",t.validate("newUserName","minlength")),e.R7$(),e.Y8G("disabled","INVALID"===t.changeUsernameForm.status))},dependencies:[c.bT,h.n,a.qT,a.me,a.BC,a.cb,a.R_,a.j4,a.JD],styles:[".flex-center-local[_ngcontent-%COMP%]{height:auto;width:30%;margin:0 auto;padding:2rem;display:flex;align-items:flex-start;justify-content:center;flex-direction:column}p[_ngcontent-%COMP%]{font-size:15px;color:var(--color-blanco-claro)}.inputs-all[_ngcontent-%COMP%]{border-radius:9px;margin-top:0}#in-change[_ngcontent-%COMP%]{width:50%;height:25%}.title[_ngcontent-%COMP%]{font-size:26px}img[_ngcontent-%COMP%]{width:24px;height:24px;margin-right:6px}"]})}return s})();function w(s,l){1&s&&(e.j41(0,"span",13)(1,"span",14),e.EFF(2,"X"),e.k0s(),e.EFF(3,"This field is required"),e.k0s())}function v(s,l){1&s&&(e.j41(0,"span",13)(1,"span",14),e.EFF(2,"X"),e.k0s(),e.EFF(3,"Incorrect Current Password"),e.k0s())}function I(s,l){1&s&&(e.j41(0,"span",13)(1,"span",14),e.EFF(2,"X"),e.k0s(),e.EFF(3,"The field is required"),e.k0s())}function b(s,l){1&s&&(e.j41(0,"span",13)(1,"span",14),e.EFF(2,"X"),e.k0s(),e.EFF(3,"Minimum 6 characters"),e.k0s())}function k(s,l){1&s&&(e.j41(0,"span",13)(1,"span",14),e.EFF(2,"X"),e.k0s(),e.EFF(3,"The field is required"),e.k0s())}function y(s,l){1&s&&(e.j41(0,"span",13)(1,"span",14),e.EFF(2,"X"),e.k0s(),e.EFF(3,"Minimum 6 characters"),e.k0s())}function _(s,l){1&s&&(e.j41(0,"span")(1,"span",14),e.EFF(2,"X"),e.k0s(),e.EFF(3,"Passwords do not match"),e.k0s())}let U=(()=>{class s{constructor(n,r,t){this.fb=n,this.router=r,this.userService=t,this.currentP="",this.userId=0,this.changePassForm=this.fb.group({currentPass:["",[a.k0.required,a.k0.minLength(6)]],newPass:["",[a.k0.required,a.k0.minLength(6)]],confirmPass:["",[a.k0.required,a.k0.minLength(6)]]})}ngOnInit(){let n=sessionStorage.getItem("user")||null;null!==n&&(n=n.replace(/[^0-9]/g,""),this.userId=parseInt(n)),this.userService.getPassword(this.userId).subscribe(r=>{this.currentP=r.password,this.changePassForm.get("currentPass")?.setValidators([a.k0.required,this.currentPasswordValidator(this.currentP)]),this.changePassForm.get("currentPass")?.updateValueAndValidity()})}ChangePassword(){if(this.changePassForm.invalid)return;const n=this.changePassForm.controls.newPass.value;this.userService.changePassword(this.userId,n),this.currentP=n,this.router.navigate(["home"]),alert("Password changed successfully")}validate(n,r){return this.changePassForm.controls[n].getError(r)&&this.changePassForm.controls[n].touched}passwordMatch(n,r){return function(t){const i=t.get(n)?.value,m=t.get(r)?.value;return i===m?null:{passwordMismatcgError:!0}}}currentPasswordValidator(n){return r=>r.value!==n?{invalidCurrentPassword:!0}:null}static#e=this.\u0275fac=function(r){return new(r||s)(e.rXU(a.ok),e.rXU(u.Ix),e.rXU(p.D))};static#n=this.\u0275cmp=e.VBU({type:s,selectors:[["app-change-pass"]],decls:23,vars:9,consts:[[1,"contenedor-forms","flex-center-100vh"],[1,"flex-center-local","forms",3,"ngSubmit","formGroup"],[1,"title"],["src","assets/candado.png"],["for","currentPass"],["type","password","placeholder","Current Password","formControlName","currentPass","pattern","^(?!\\s*$).+","title","It cannot be blank",1,"inputs-values","inputs-all"],["class","error-message",4,"ngIf"],["for","newPass"],["type","password","id","","placeholder","New Password","formControlName","newPass",1,"inputs-values","inputs-all"],["for","confirmPass"],["type","password","placeholder","Confirm Password","formControlName","confirmPass",1,"inputs-values","inputs-all"],[4,"ngIf"],["type","submit","value","Change Password",1,"inputs-sumbit","inputs-all",3,"disabled"],[1,"error-message"],[1,"cross-error"]],template:function(r,t){if(1&r&&(e.j41(0,"div",0)(1,"form",1),e.bIt("ngSubmit",function(){return t.ChangePassword()}),e.j41(2,"h3",2),e.nrm(3,"img",3),e.EFF(4,"Change Password"),e.k0s(),e.j41(5,"label",4),e.EFF(6,"Current Password"),e.k0s(),e.nrm(7,"input",5),e.DNE(8,w,4,0,"span",6)(9,v,4,0,"span",6),e.j41(10,"label",7),e.EFF(11,"New Password"),e.k0s(),e.nrm(12,"input",8),e.DNE(13,I,4,0,"span",6)(14,b,4,0,"span",6),e.j41(15,"label",9),e.EFF(16,"Confirm Password"),e.k0s(),e.nrm(17,"input",10),e.DNE(18,k,4,0,"span",6)(19,y,4,0,"span",6)(20,_,4,0,"span",11),e.nrm(21,"input",12),e.k0s()(),e.nrm(22,"app-footer")),2&r){let i,m;e.R7$(),e.Y8G("formGroup",t.changePassForm),e.R7$(7),e.Y8G("ngIf",t.validate("currentPass","required")),e.R7$(),e.Y8G("ngIf",(null==(i=t.changePassForm.get("currentPass"))?null:i.hasError("invalidCurrentPassword"))&&(null==(i=t.changePassForm.get("currentPass"))?null:i.touched)),e.R7$(4),e.Y8G("ngIf",t.validate("newPass","required")),e.R7$(),e.Y8G("ngIf",t.validate("newPass","minlength")),e.R7$(4),e.Y8G("ngIf",t.validate("confirmPass","required")),e.R7$(),e.Y8G("ngIf",t.validate("confirmPass","minlength")),e.R7$(),e.Y8G("ngIf",(null==t.changePassForm.errors?null:t.changePassForm.errors.passwordMismatcgError)&&(null==(m=t.changePassForm.get("newPass"))?null:m.touched)&&(null==(m=t.changePassForm.get("confirmPass"))?null:m.touched)),e.R7$(),e.Y8G("disabled","INVALID"===t.changePassForm.status)}},dependencies:[c.bT,h.n,a.qT,a.me,a.BC,a.cb,a.R_,a.j4,a.JD],styles:[".flex-center-local[_ngcontent-%COMP%]{height:auto;width:30%;margin:0 auto;padding:2rem;display:flex;align-items:flex-start;justify-content:center;flex-direction:column}.title[_ngcontent-%COMP%]{font-size:25px}.inputs-sumbit[_ngcontent-%COMP%]{width:150px}.inputs-all[_ngcontent-%COMP%]{border-radius:9px;margin-top:0}img[_ngcontent-%COMP%]{width:20px;height:20px;margin-right:6px}label[_ngcontent-%COMP%]{font-size:15px;color:var(--color-blanco-claro)}"]})}return s})();function N(s,l){1&s&&(e.j41(0,"span",11)(1,"span",12),e.EFF(2,"X"),e.k0s(),e.EFF(3,"The field is required"),e.k0s())}function j(s,l){1&s&&(e.j41(0,"span")(1,"span",12),e.EFF(2,"X"),e.k0s(),e.EFF(3,"Invalid Email Format "),e.k0s())}function T(s,l){1&s&&(e.j41(0,"span",11)(1,"span",12),e.EFF(2,"X"),e.k0s(),e.EFF(3,"The field is required"),e.k0s())}function x(s,l){1&s&&(e.j41(0,"span",11)(1,"span",12),e.EFF(2,"X"),e.k0s(),e.EFF(3," Incorrect Password"),e.k0s())}let G=(()=>{class s{constructor(n,r,t){this.fb=n,this.router=r,this.userService=t,this.userId=0,this.currentP="",this.emailPattern=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,this.changeEmailForm=this.fb.group({newEmail:["",[a.k0.required,a.k0.pattern(this.emailPattern)]],password:["",[a.k0.required]]})}ngOnInit(){let n=sessionStorage.getItem("user")||null;null!==n&&(n=n.replace(/[^0-9]/g,""),this.userId=parseInt(n),this.userService.getPassword(this.userId).subscribe(r=>{this.currentP=r.password,this.changeEmailForm.get("password")?.setValidators([a.k0.required,this.currentPasswordValidator(this.currentP)]),this.changeEmailForm.get("password")?.updateValueAndValidity()}))}ChangeEmail(){if(this.changeEmailForm.invalid)return;const n=this.changeEmailForm.controls.newEmail.value;this.userId&&this.userService.checkIfEmailExists(this.changeEmailForm.controls.newEmail.value).subscribe(r=>{r?alert("Email already exists. Please try another one!"):(this.userService.changeEmail(this.userId,n),alert("Email changed successfully!"),this.router.navigate(["home"]))})}currentPasswordValidator(n){return r=>r.value!==n?{invalidCurrentPassword:!0}:null}static#e=this.\u0275fac=function(r){return new(r||s)(e.rXU(a.ok),e.rXU(u.Ix),e.rXU(p.D))};static#n=this.\u0275cmp=e.VBU({type:s,selectors:[["app-change-email"]],decls:17,vars:6,consts:[[1,"contenedor-forms","flex-center-100vh"],[1,"flex-center-local","forms",3,"ngSubmit","formGroup"],[1,"title"],["src","assets/email.png"],["for","new Email"],["type","email","placeholder","New Email","formControlName","newEmail","pattern","^(?!\\s*$).+","title","It cannot be blank",1,"inputs-values","inputs-all"],["class","error-message",4,"ngIf"],[4,"ngIf"],["for","password"],["type","password","placeholder","Password","formControlName","password","pattern","^(?!\\s*$).+","title","It cannot be blank",1,"inputs-values","inputs-all"],["type","submit","value","Change Email",1,"inputs-sumbit","inputs-all",3,"disabled"],[1,"error-message"],[1,"cross-error"]],template:function(r,t){if(1&r&&(e.j41(0,"div",0)(1,"form",1),e.bIt("ngSubmit",function(){return t.ChangeEmail()}),e.j41(2,"h3",2),e.nrm(3,"img",3),e.EFF(4,"Change Email"),e.k0s(),e.j41(5,"label",4),e.EFF(6,"Write your new Email"),e.k0s(),e.nrm(7,"input",5),e.DNE(8,N,4,0,"span",6)(9,j,4,0,"span",7),e.j41(10,"label",8),e.EFF(11,"Write your current password"),e.k0s(),e.nrm(12,"input",9),e.DNE(13,T,4,0,"span",6)(14,x,4,0,"span",6),e.nrm(15,"input",10),e.k0s()(),e.nrm(16,"app-footer")),2&r){let i;e.R7$(),e.Y8G("formGroup",t.changeEmailForm),e.R7$(7),e.Y8G("ngIf",t.changeEmailForm.controls.newEmail.getError("required")&&t.changeEmailForm.controls.newEmail.touched),e.R7$(),e.Y8G("ngIf",t.changeEmailForm.controls.newEmail.touched&&t.changeEmailForm.controls.newEmail.getError("pattern")),e.R7$(4),e.Y8G("ngIf",t.changeEmailForm.controls.password.getError("required")&&t.changeEmailForm.controls.password.touched),e.R7$(),e.Y8G("ngIf",(null==(i=t.changeEmailForm.get("password"))?null:i.hasError("invalidCurrentPassword"))&&(null==(i=t.changeEmailForm.get("password"))?null:i.touched)),e.R7$(),e.Y8G("disabled","INVALID"===t.changeEmailForm.status)}},dependencies:[c.bT,h.n,a.qT,a.me,a.BC,a.cb,a.R_,a.j4,a.JD],styles:[".flex-center-local[_ngcontent-%COMP%]{height:auto;width:30%;margin:0 auto;padding:2rem;display:flex;align-items:flex-start;justify-content:center;flex-direction:column}img[_ngcontent-%COMP%]{width:23px;height:23px;margin-right:9px}.title[_ngcontent-%COMP%]{font-size:28px}.inputs-sumbit[_ngcontent-%COMP%]{width:125px;height:35px}.inputs-all[_ngcontent-%COMP%]{border-radius:9px;margin-top:0}"]})}return s})();var g=o(6225);const M=[{path:"change-username",component:E,canActivate:[g.l]},{path:"change-pass",component:U,canActivate:[g.l]},{path:"change-email",component:G,canActivate:[g.l]}];let $=(()=>{class s{static#e=this.\u0275fac=function(r){return new(r||s)};static#n=this.\u0275mod=e.$C({type:s});static#s=this.\u0275inj=e.G2t({imports:[u.iI.forChild(M),u.iI]})}return s})();var R=o(401),f=o(4804);let S=(()=>{class s{static#e=this.\u0275fac=function(r){return new(r||s)};static#n=this.\u0275mod=e.$C({type:s});static#s=this.\u0275inj=e.G2t({imports:[c.MD,$,f.c,R.G,a.X1,f.c,a.YN]})}return s})()}}]);